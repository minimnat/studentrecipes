<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Database Example</title>

</head>
<body>

	<div id='cars'></div>

	<script id='myTemplate' type='text/ractive'>
    	{{#recipelist}}
			<p>{{id}},{{type}},{{title}},{{recipe}}!</p>
		{{/recipelist}}
	</script>

	<!--<script src='Ractive.min.js'></script>-->

	<script>

		//open database
		var db = openDatabase('mydb4', '1.0', 'my first database', 2 * 1024 * 1024);
		db.transaction(function (tx) {
  			tx.executeSql('DROP TABLE recipe');
			});
			
		db.transaction(function (tx) {
  			tx.executeSql('CREATE TABLE recipe (id UNIQUE, type TEXT, title TEXT, recipe BLOB)');
		
		var recipe1=new Object ();
			recipe1.id = 1;
			recipe1.type ="Chicken";
			recipe1.title ="Black Bean Stir-Fry";
			recipe1.ingredients = ["Skinless chicken breasts 2 large, cut into chunks", "Groundnut oil 1tbsp", "Red pepper 1 deseeded and sliced", 						"Yellow pepper 1 deseeded and sliced","Chinese black bean sauce 2 tbsp", "Light soy sauce 1 tbsp","Chicken stock 60ml", "Cornflour 2 tsp","Cooked 	long grain rice 250g (optional)"];
			recipe1.instructions = ["To make the marinade combine ingredients" , " Mix all ingredients into bowl " , "Add chicken and mix until 	covered all over", "Put into refrigerator for 15-20 minutes", "Ready to cook" , "Heat the oil in a wok or large frying pan" ," Once hot add chicken and stir for 4-5 minutes", " When golden, remove from wok or frying pan","Adding the peppers to the wok or frying pan" , "Brisk heat 	for 3 minutes", "Return chicken to wok or frying pan, add black bean sauce, Cook for another 2 minutes" , "Combine soy sauce, chicken stock, cornflour in a bowl, adding 2 tbsp of water. Pour into wok or frying pan", "Simmer gently for 3 minutes, until sauce is thick" , "Serve with rice"];
		
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe1.id, recipe1.type, recipe1.title,recipe1]);
			
				
			var recipe2=new Object ();
			recipe2.id = 2;
			recipe2.type ="Pork";
			recipe2.title ="Sausage Casserole";
			recipe2.ingredients = ["Sausages 16","Passata 1 jar or 2 cartons" ,"Baked beans 2 Cans", "Sprinkling of chilli powder",
			"Garlic 1-2 chopped","Onions 1 chopped","Sprinkling of black pepper" ,"Sugar 1 ts"];
			recipe2.instructions = ["Peel and dice onions","Peel and thinly slice garlic","Either heat sausages in a frying pan with oil and  	onions and garlic" ,"Or bake sausages, brushing with a fair bit of oil, place the onions and garlic on top, and bake for about 20 mins on medium heat" ,"Pour passata and beans into a large casserole dish","Sprinkle chilli and pepper to taste", "Spoon sugar, then add mustard if required, and stir it all up","Remove onions, garlic and sausages from the oven","Spoon saucy mix","Put lid on dish, and bake at medium heat for an hour", "Option to serve with mashed potato"];   
			
					
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe2.id, recipe2.type, recipe2.title,recipe2]);
							
	        var recipe3=new Object ();
			recipe3.id = 3;
			recipe3.type ="Fish";
			recipe3.title ="Salmon with couscous";
			recipe3.ingredients = ["Lemon juice 1 ", "Olive oil 2tbsp", "Salt and pepper","Skinless salmon 		fillets 2 150g-175g each","Lemon, mint and parsley couscous 100g", "Rocket leaves 20g","Light mayonnaise 	2tbsp"];   
			recipe3.instructions = ["To make the marinade, combine lemon juice and 1 tbsp of oil.","Add salmon fillets and turn twice ensuring coating is all over.","Cover and marinate for 15-20 minutes.",
"Preheat overn to 220C.","Drizzle remaining oil into a roastin tin.","Drain salmon and put into tin.","Roast for 15-20 minutes until salmon is starting to go crisp.","Put couscous into bowl, add boiling water.","Leave to stand for 5 mintues to absorb water.","Plate couscous on plate, rocket leaves.","Add mayonnaise if required."];
		
			
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe3.id, recipe3.type, recipe3.title,recipe3]);
		
		
			var recipe4=new Object ();
			recipe4.id = 4;
			recipe4.type ="Specific";
			recipe4.title ="Crunchy bacon salad";
			recipe4.ingredients = ["Extra virgin olive oil 1tbsp", "Focaccia 75g", "Bacon lardons 110g","Garlic 2 cloves, peeled and chopped","Mixed salad leaves 50g","Lime 1, juice","Salt and pepper"];   			
			recipe4.instructions = ["Heat the oil in a large frying pan.","Add bacon and cook for 5 minutes.","Add focaccia and continue cooking, for another 5 minutes until bread is crispy.",
"Add girlic and stir for a few minutes.","Arrange mixed salad leaves on a plate.","Scatter hot bacon over top.","Drizzle with extra olive oil, salt and pepper and lime juice."];
			
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe4.id, recipe4.type, recipe4.title,recipe4]);
		
			var recipe5=new Object ();
			recipe5.id = 5;
			recipe5.type ="Specific";
			recipe5.title ="Jacket Potatoes With Tuna";
			recipe5.ingredients = ["Baking potatoes 2", "Olive oil 2 tsp", "Salt and pepper","Tuna chunks 185g","Light mayonnaise 3-4 tbsp","Lime 1, juice","Mixed salad leaves"];   			
			recipe5.instructions = ["Preheat oven to 200C/400F.","Put potatoes in small roasting tin, prick several times.","Drizzle with a teaspoon of olive oil.","Sprinkle salt and pepper.","Bake until potatoes are tender, usually about 1 hour.","Mix tuna with mayonnaise.","Season with lime and salt and pepper.","Divide cooked potatoes, add tuna mix.", "Serve with mixed leaves."];
			
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe5.id, recipe5.type, recipe5.title,recipe5]);
		
		
		    var recipe6=new Object ();
			recipe6.id = 6;
			recipe6.type ="Specific";
		    recipe6.title ="Tomato Frittata";
			recipe6.ingredients = ["Eggs 6 large", "Sun-dried tomatoes 8", "Parmesan-style cheese 50g","Olive oil 2 tbsp","Onion 1, peeled and sliced","Tomato salad"];   			
			recipe6.instructions = ["Preheat grill.","Break eggs whisk briefly.","Add sun-dried tomatoes and parmesan cheese and mix together.","Heat oil  in pan.","Add onion and cook for 5 minutes.","Pour egg mix into pan and stir.","Cook over a medium heat, until base is golden.","Slide pan under grill until golden on top.","Plate up with option of salad or wedges."];
		
		tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe6.id, recipe6.type, recipe6.title,recipe6]);
		
		
		
		    var recipe7=new Object ();
			recipe7.id = 7;
			recipe7.type ="Specific";
		    recipe7.title ="Spag Bowl";
			recipe7.ingredients = ["Olive oil 1/2 tbsp","Onion 1 diced","Garlic clove 1 crushed","Mince 500g","Carrot 1 sliced","Red pepper 1 cubed", "Mushrooms 250g","Tin tomatoes 1", "Tomato puree 1/2 tube","Bay leaves 2-3", "Salt and pepper","Spaghetti to serve",];   			
			recipe7.instructions = ["Heat oil in a pot and fry onions and garlic.","Brown mince removing any excess fluid.","Add vegetables and cook for a minute.","Add salt and pepper  and stir thoroughly.","Add tinned tomatoes,puree and bay leaves and stir thoroughly.","Bring to the boil.","Leave to simmner fo 50 minutes - hour.","Serve with spaghetti and garlic bread."];
		tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe7.id, recipe7.type, recipe7.title,recipe7]);
		
						<!--alert(recipe.instructions);-->
							
							

				
        	});
			
			db.transaction(function (tx) {
  				tx.executeSql('SELECT * FROM recipe', [], function (tx, results) {
  				var len = results.rows.length, i;
  					for (i = 0; i < len; i++) {
    				alert(results.rows.item(i).type);
 					}
					}); 
			});
			
			//Database transactions are asynchronous. 
			//That means that normally this loop would continue to loop over each car 
			//without waiting for the database to write the record. 
			
			//By the time the transactions are being undertaken the loop has finished 
			//and the looping variable, i, has hit its maximum so only the last car is written. 
			
			//One way to fix this problem is to place the transaction in something called an anonymous function.
			//where 'i' is passed as a parameter to the function
			
      		/*(function(i) {
        		db.transaction(function (tx) {  
               	tx.executeSql('INSERT INTO type (type, recipe) VALUES (?,?,?)',  [i, cars[i].model, cars[i].colour]);
        		});
      		});
    	};


		//This defines the data binding using Ractive.js
		var ractive = new Ractive({
            el: 'recipe',
            template: '#myTemplate',
            data: { recipelist: recipe}
        });
*/

	</script>

</body>
</html>
