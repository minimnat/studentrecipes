<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Database Example</title>

</head>
<body>

	<div id='cars'></div>

	<script id='myTemplate' type='text/ractive'>
    	{{#recipelist}}
			<p>{{id}},{{type}},{{title}},{{recipe}}!</p>
		{{/recipelist}}
	</script>

	<!--<script src='Ractive.min.js'></script>-->

	<script>

		//open database
		var db = openDatabase('mydb4', '1.0', 'my first database', 2 * 1024 * 1024);
		db.transaction(function (tx) {
  			tx.executeSql('DROP TABLE recipe');
			});
			
		db.transaction(function (tx) {
  			tx.executeSql('CREATE TABLE recipe (id UNIQUE, type TEXT, title TEXT, recipe BLOB)');
		
		var recipe1=new Object ();
			recipe1.id = 1;
			recipe1.type ="Chicken";
			recipe1.title ="Black Bean Stir-Fry";
			recipe1.ingredients = ["Skinless chicken breasts 2 large, cut into chunks", "Groundnut oil 1tbsp", "Red pepper 1 deseeded and sliced", 						"Yellow pepper 1 deseeded and sliced","Chinese black bean sauce 2 tbsp", "Light soy sauce 1 tbsp","Chicken stock 60ml", "Cornflour 2 tsp","Cooked 	long grain rice 250g (optional)"];
			recipe1.instructions = ["To make the marinade combine ingredients" , " Mix all ingredients into bowl " , "Add chicken and mix until 	covered all over", "Put into refrigerator for 15-20 minutes", "Ready to cook" , "Heat the oil in a wok or large frying pan" ," Once hot add chicken and stir for 4-5 minutes", " When golden, remove from wok or frying pan","Adding the peppers to the wok or frying pan" , "Brisk heat 	for 3 minutes", "Return chicken to wok or frying pan, add black bean sauce, Cook for another 2 minutes" , "Combine soy sauce, chicken stock, cornflour in a bowl, adding 2 tbsp of water. Pour into wok or frying pan", "Simmer gently for 3 minutes, until sauce is thick" , "Serve with rice"];
		
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe1.id, recipe1.type, recipe1.title,recipe1]);
			
				
			var recipe2=new Object ();
			recipe2.id = 2;
			recipe2.type ="Chicken";
			recipe2.title ="Curried Chicken";
			recipe2.ingredients = ["Olive oil 1 tbsp" ,"Onion 1 peeled and chopped", "Skinless chicken fillets diced","Korma curry paste 1-3 tbsp",									"Double cream 4 tbsp" ,"Mango 1 peeled, stoned and diced"];
			recipe2.instructions = ["Heat 1 table spoon of oil in a large frying pan","Add onion and cook for 5 minutes, until softened",
"Add chicken, more oil if needed","Continue cooking for another 5 minutes, stir often","Stir in curry paste, including 3-4 tbsp of water",
"Continue for another 5 mintues","Add cream, continue cooking until sauce is thick and chicken is cooked",
"Stir in mango after taking pan off the heat"];
			
					
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe2.id, recipe2.type, recipe2.title,recipe2]);
							
	        var recipe3=new Object ();
			recipe3.id = 3;
			recipe3.type ="Pork";
			recipe3.title ="Sausage Casserole";
			recipe3.ingredients = ["Sausages 16","Passata 1 jar or 2 cartons" ,"Baked beans 2 Cans", "Sprinkling of chilli powder",
			"Garlic 1-2 chopped","Onions 1 chopped","Sprinkling of black pepper" ,"Sugar 1 ts"];
			recipe3.instructions = ["Peel and dice onions","Peel and thinly slice garlic","Either heat sausages in a frying pan with oil and  	onions and garlic" ,"Or bake sausages, brushing with a fair bit of oil, place the onions and garlic on top, and bake for about 20 mins on medium heat" ,"Pour passata and beans into a large casserole dish","Sprinkle chilli and pepper to taste", "Spoon sugar, then add mustard if required, and stir it all up","Remove onions, garlic and sausages from the oven","Spoon saucy mix","Put lid on dish, and bake at medium heat for an hour", "Option to serve with mashed potato"];   
			
			tx.executeSql('INSERT INTO recipe (id,type, title, recipe) VALUES (?,?,?,?)',  [recipe3.id, recipe3.type, recipe3.title,recipe3]);
		
			var recipe=new Object ();
			recipe.id = 4;
			recipe.type ="Pork";
			recipe.title ="Pork Noodles";
			recipe.ingredients = ["Chinese egg noodles 335g", "Soy sauce 3 tbsp", "Thai sweet chilli sauce 180ml","Garlic granules 1/2 ts",
"Ground ginger 1/4 ts","Sesame oil 3tbsp","Soy sauce 120m","Garlic granules 1/2 ts","Pork fillet, cut into strips 1 (450g)","Vegatable oil 2tbsp","Onions 2, chopped","Pinch crushed chilli flakes","Thai sweet chilli sauce 3tbsp","Savoy cabbage 1/2","Stalks celery 4, sliced","Carrots 2, sliced","Red peppers 3 chopped","Cornflour 2 ts","Cold water 4tbsp"];
			recipe.instructions = ["Fill a large pot salted water and bring to a rolling boil","Stir in the Chinese noodles, and return to the boil","Cook the noodles uncovered, stirring occasionally","Drain well", "Whisk together the 3 tablespoons soy sauce, 180ml sweet chilli sauce, 1/2 teaspoon garlic granules, the ground ginger and the sesame oil in a large bowl","Add noodles and toss to coat","Whisk together the 120ml soy sauce and 1/2 teaspoon garlic granules in a large bowl,add the pork and stir to coat","Allow to marinate for 5 minutes","Heat the cooking oil in a wok or a large, deep frying pan over medium-high heat","Add the pork, onions, and crushed chilli flakes to the oil","Stir in 3 tablespoons sweet chilli sauce, cabbage, celery, carrots and peppers", "Whisk together the cornflour and water and add to the stir fry, stirring until the mixture thickens","Serve the stir-fry over the noodles"];
			
		
							alert(recipe.title);
							
							

				
        	});
			
			db.transaction(function (tx) {
  				tx.executeSql('SELECT * FROM recipe', [], function (tx, results) {
  				var len = results.rows.length, i;
  					for (i = 0; i < len; i++) {
    				alert(results.rows.item(i).title);
 					}
					}); 
			});
			
			//Database transactions are asynchronous. 
			//That means that normally this loop would continue to loop over each car 
			//without waiting for the database to write the record. 
			
			//By the time the transactions are being undertaken the loop has finished 
			//and the looping variable, i, has hit its maximum so only the last car is written. 
			
			//One way to fix this problem is to place the transaction in something called an anonymous function.
			//where 'i' is passed as a parameter to the function
			
      		/*(function(i) {
        		db.transaction(function (tx) {  
               	tx.executeSql('INSERT INTO type (type, recipe) VALUES (?,?,?)',  [i, cars[i].model, cars[i].colour]);
        		});
      		});
    	};


		//This defines the data binding using Ractive.js
		var ractive = new Ractive({
            el: 'recipe',
            template: '#myTemplate',
            data: { recipelist: recipe}
        });
*/

	</script>

</body>
</html>
